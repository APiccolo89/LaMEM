# Detachment folding setup to be used to generate a movie for GeoMod2010

# Define number of elements in x,y & z-direction (should be uneven!)
nel_x						=	4 
nel_y						= 	4 
nel_z						= 	16			

# Geometry
DimensionalUnits			=	1			# Dimensionless (=0) or SI-dimensional units (=1)?
L						=	30e3			# Length (y-direction)
W						=	30e3			# Width  (x-direction)
H						=	30e3			# Height (z-direction)
x_left					=	0			# Left side of domain
y_front					=	0			# Front side of domain
z_bot						=	-30e3			# Bottom of box

# Define model setup and noise
Setup.Model				=	3			# 0-detachment folding setup  4-multilayer folding
ampl2D					=	0.0	 		# Amplitude of 2D sinuoidal perturbtion
ampl3D					=	0.0			# Amplitude of 3D sinuoidal perturbtion
amplNoise					=	0.0	 		# Amplitude of noise @ interface

# Define input/output and numerics-related stuff
OutputFile					=	ThinSheet_Output		
save_timesteps				=	1			# save every ? timesteps
time_end					=	4 			# last timestep
CFL						=	1			# CFL, dt-based criterium
dt_max					=	5e2 	  		# Maximum timestep [years if dimensional]
time_end_temp	 			= 	2			# last timestep for temperature initialization
dt_temp 					= 	1e9			# timestep for temperature initialization
		
# Boundary conditions
BC.Eyy					=	0e-15			# BG strainrate in y-direction
BC.Exx					=	1e-15			# BG Strainrate in x-direction
BC.LeftBound				=	6			# 0 - free surface, 1-free slip with BG strainrate Eyy, 2 - no slip, 3-periodic
BC.RightBound				=	1			# 0 - free surface, 1-free slip with BG strainrate Eyy, 2 - no slip, 3-periodic
BC.FrontBound				=	1			# 0 - free surface, 1-free slip with BG strainrate Exx, 2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.BackBound				=	1			# 0 - free surface, 1-free slip with BG strainrate Exx, 2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.LowerBound				=	5			# 0 - free surface, 1-free slip, 				  2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.UpperBound				=	0			# 0 - free surface, 1-free slip, 				  2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
Temp_top	    				=   	283 			# Temperature @ top
Temp_bottom				=   	623  			# Temperature @ bottom; side BC's are flux-free
temp_initialize 			=	1			# 1 - initialize temperature, 0 - don't initialize temperature (default)

# Grid advection method
GridAdvectionMethod			= 	1 			# 0-Fully Eulerian, 1-Fully Lagrangian, 2-ALE with remeshing @ surface layer
FactorSurfaceLayer			= 	1 			# How thick is the surface layer (if option 2 is selected above) ?

# Define Stokes Solver
StokesSolver 				=	2   # 1 - Powell-Hesteness iterations; 2 - Schur Complement Reduction; 3 - Fully Coupled Solver 
VelocitySolver              =   2   # 0 - User defined; 1 - Direct (MUMPS); 2 - Galerkin geometric multigrid; 3 - Fieldsplit + Algebraic Multigrid (ML)

# Define nonlinear solver options
NonlinearIterationsAccuracy	= 	5e-4		# Stopping criterium for power-law loop
MaxNonlinearIterations		= 	25			# Maximum number of nonlinear iterations

<PetscOptionsStart>

# Fine-tune solver options here (add command-line Petsc Options)

	-vpt_element Q2Pm1_global					# Type of element [Q2Pm1_global; Q2Pm1_local; Q1P0]
	
<PetscOptionsEnd>

# Phase distribution
ParticleInput 			=   1						# Use particles to track properties? 0-no; 1-yes
ParticleFilename		=   input/ParticlesInput_Tbenchmark_2phase.dat		# File that contains particle distribution
SaveTracers 			=   0                 		# Write particles to disk?
NumPartX				=   3						# Particles/Cell in x-direction
NumPartY				=   3						# Particles/Cell in y-direction
NumPartZ				=   3						# Particles/Cell in z-direction

# Read initial grid from file?
InitialMeshFromFile 		=   0 					# In case you want to hand-modify the initial grid
InitialMeshFileName 		=   Grid_in.dat	
InitialMantleLevel		=   0						# Set to zero to deactivate

# Properties that are defined over the whole domain:
Gravity					=	10;						# [m/s2] - gravitational acceleration 
PlasticityModel				=	0;						#  not implemented yet
Xi						=	0;						# [ ] - Shear heating factor - not implemented yet
GasConstant 				= 	8.3144621;					# J/molK

# Define characteristic values, used if DimensionalUnits==1, otherwise ignored
Characteristic.Length			=	30e3				# [m]
Characteristic.Viscosity 		=	1e26 				#2.5e21			#1e20				# [Pa.s]
Characteristic.Temperature		=	623 				# [K]
Characteristic.Stress      	=   	1e12				#1e5				# [Pa]

# Define phase transitions for particles
num_phase_transitions			=	0				# The number of phase transitions present

# Define material properties for all phases -------------------------------------------------
num_phases					=	2				# Total number of phases defined in code
LowerViscosityCutoff			=	1e19;
UpperViscosityCutoff			=	1e50;

	# Define properties of crust-----------------
	<MaterialStart>
		phase_id 			=	0
		attribute 			= 	VISCOSITY
		type 				= 	tempdep_nopowerlaw		
		PreExpFactor		=	3.2e-20 		
		#eta0       		= 	1e22
		N_exp				=	3 		
		e0				=	1 			
		ActivationEnergy	= 	276000 		
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	0
		attribute 			= 	DENSITY
		type 				= 	temperature_dependent
		rho0        		= 	2700
		alpha 			=	0
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	0
		attribute 			= 	ENERGY
		type 				= 	constant
		ThermalConductivity	= 	2.1 
		HeatCapacity		=	1050
		RadioactiveHeat		=	0.4e-6 
		ShearHeating		=	0
	<MaterialEnd>

	# Define properties of crust-----------------
	<MaterialStart>
		phase_id 			=	1
		attribute 			= 	VISCOSITY
		type 				= 	tempdep_nopowerlaw		
		PreExpFactor		=	3.16e-26
		#eta0       		= 	1e24	
		N_exp				=	3.3
		e0				=	1 			
		ActivationEnergy	= 	190000
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	1
		attribute 			= 	DENSITY
		type 				= 	temperature_dependent
		rho0        		= 	2700
		alpha 			=	0
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	1
		attribute 			= 	ENERGY
		type 				= 	constant
		ThermalConductivity	= 	2.5 
		HeatCapacity		=	1050
		RadioactiveHeat		=	1.4e-6
		ShearHeating		=	0
	<MaterialEnd>

# End of defining material properties for all phases ----------------------------------------
