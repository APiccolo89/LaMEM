# ----------------------------------------------------------------------------------------------------------------------
# A basic parameter file for FDSTAG setups
# ----------------------------------------------------------------------------------------------------------------------

# --- General I/O related parameters ---
# Define input/output and numerics-related stuff
OutputFile					=	Gravity_test		
save_timesteps				=	1		# save every X timesteps
save_breakpoints			= 	-1 		# save breakpoints; -1: don't save breakpoints + initial particles
										# save breakpoints;  0: it saves initial particles !
time_end					=	2		# last timestep
CFL							=	1		# ? CFL, dt-based criterium
dt_max						=	1e-5	# ? Maximum timestep [years if dimensional]
LoadInitialParticlesFromDisc=	0		

# --- Number of elements in x,y,z-direction --- 
# why ?(should be uneven!)
nel_x						=	8     
nel_y						= 	8    
nel_z						=   8	

# --- Geometry --- 
DimensionalUnits			=	0		# Dimensionless (=0) or SI-dimensional units (=1)?
L							=	1		# Length (y-direction)
W							=	1		# Width  (x-direction)
H							=	1		# Height (z-direction)
x_left						=	0		# Left side of domain
y_front						=	0		# Front side of domain
z_bot						=	0		# Bottom of box

# --- Model setup and noise ---
Setup.Model					=	2		# 0-Diapir, 1-Single Layer Fold, 2-Falling block, 
										# 3-from Particle file (defined below), 4-multilayer detachment fold,
										# 5-Single Layer Growthrate
ampl2D						=	0	 	# ? Amplitude of 2D sinuoidal perturbtion
ampl3D						=	0.0		# ? Amplitude of 3D sinuoidal perturbtion
amplNoise					=	0.0	 	# ? Amplitude of noise @ interface



# --- Boundary conditions ---
BC.Eyy						=	0.0		# BG strainrate in y-direction
BC.Exx						=	0.0		# BG Strainrate in x-direction
BC.LeftBound				=	1		# 0 - free surface, 1-free slip with BG strainrate Eyy, 2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.RightBound				=	1		# 0 - free surface, 1-free slip with BG strainrate Eyy, 2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.FrontBound				=	1		# 0 - free surface, 1-free slip with BG strainrate Exx, 2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.BackBound				=	1		# 0 - free surface, 1-free slip with BG strainrate Exx, 2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.LowerBound				=	1		# 0 - free surface, 1-free slip,2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
BC.UpperBound				=	1		# 0 - free surface, 1-free slip,2 - no slip, 5 - growthrate 2D, 7 - growthrate 3D
Temp_top	    			=   0		# Temperature @ top
Temp_bottom					=   1 		# Temperature @ bottom; side BC's are flux-free


# --- Phase distribution ---
NumPartX				=	2			# ? Particles/Cell in x-direction
NumPartY				=	2			# ? Particles/Cell in y-direction
NumPartZ				=	2			# ? Particles/Cell in z-direction


# --- Properties that are defined over the whole domain ---
Gravity					=	9.81		# [m/s2] - gravitational acceleration 
PlasticityModel			=	0			# ? not implemented yet
Xi						=	0			# ? shear heating factor - not implemented yet


# --- Phase transitions for particles ---
num_phase_transitions	=	0			# ? The number of phase transitions present


# --- Viscosity Cutoff ---
LowerViscosityCutoff	=	0.1
UpperViscosityCutoff	=	1e4


# --- Grid advection method ---
GridAdvectionMethod		= 	1 			# ? 0-Fully Eulerian, 1-Fully Lagrangian, 2-ALE with remeshing @ surface layer
FactorSurfaceLayer		= 	0.3 		# ? How thick is the surface layer (if option 2 is selected above) ?

# --- Material properties of phases ------------------------------------------------------------------------------------

# --- number of phases --- 
num_phases = 2

	# material 2
	<MaterialStart>
		phase_id 			=	1
		attribute 			= 	VISCOSITY
		type 				= 	constant 					#power_law
		eta0       			= 	1e3	
		N_exp       		= 	3	
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	1
		attribute 			= 	DENSITY
		type 				= 	temperature_dependent
		rho0        		= 	2.00
		alpha 				=	0
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	1
		attribute 			= 	ELASTICITY
		type 				= 	constant
		shear        		= 	5e10
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	1
		attribute 			= 	ENERGY
		type 				= 	constant
		ThermalConductivity	= 	3
		HeatCapacity		=	1050
		RadioactiveHeat		=	0
		ShearHeating		=	0
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	1
		attribute 			= 	PLASTICITY
		type 				= 	constant
		Cohesion        		= 	20e60
		FrictionAngle		= 	30
	<MaterialEnd>
	
	
	# material 1
	<MaterialStart>
		phase_id 			=	0
		attribute 			= 	VISCOSITY
		type 				= 	constant 					#power_law
		eta0       			= 	1	
		N_exp       		= 	1
	<MaterialEnd>
	<MaterialStart>
		phase_id 			= 	0
		attribute 			= 	DENSITY
		type 				= 	temperature_dependent
		rho0        		= 	1.0
		alpha 				=	0
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	0
		attribute 			= 	ELASTICITY
		type 				= 	constant
		shear        		= 	5e10
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	0
		attribute 			= 	ENERGY
		type 				= 	constant
		ThermalConductivity	= 	3
		HeatCapacity		=	1050
		RadioactiveHeat		=	0
		ShearHeating		=	0
	<MaterialEnd>
	<MaterialStart>
		phase_id			= 	0
		attribute 			= 	PLASTICITY
		type 				= 	constant
		Cohesion        	= 	20e60
		FrictionAngle		= 	30
	<MaterialEnd>


StokesSolver   = 3   # 1 - Powell-Hesteness iterations; 2 - Schur Complement Reduction; 3 - Fully Coupled Solver 
VelocitySolver = 3   # 0 - User defined; 1 - Direct (MUMPS); 2 - Galerkin geometric multigrid; 3 - Fieldsplit + Algebraic Multigrid (ML)


# === PETSC command line options =======================================================================================
<PetscOptionsStart>

-save_GravityFieldRef 1

# --- outputfiles ? ---
-VTKOutputFiles 0 
-MatlabOutputFiles 0
#-restart 0 

# --- element type ---
-vpt_element FDSTAG

# set options that deviate from defaults
-fc_ksp_monitor
-use_stokes_residual false
-use_stokes_monitor false

<PetscOptionsEnd>
# ======================================================================================================================
