Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00000 
#    rho0[1] = 1.00000 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0215664 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0732815 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492586891546e+01 
    1 KSP Residual norm 1.087264268383e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.530622 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.372397282794e-06 
      |Div|_2   = 3.489134765136e-04 
   Momentum: 
      |mRes|_2  = 1.717514137048e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0647264 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019507856100
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.122200754588e-07 
    1 KSP Residual norm 2.163225134946e-12 
1.Gradient (dimensional) = -0.0000000006125340193972862955112294798847 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005527110952926331997293063502154 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015092032734362243842391078 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0458248 s
******************************************
Total solution time : 0.900007 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000000000000
2. Parameter value = 1.000000000000
mfit / mfit0 = 1.000000000000
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00000 
#    rho0[1] = 1.00000 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0165083 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0640078 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492586856985e+01 
    1 KSP Residual norm 1.087264254053e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.52266 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.372397427089e-06 
      |Div|_2   = 3.489134730606e-04 
   Momentum: 
      |mRes|_2  = 1.717514145578e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0652244 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019507853957
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.122200248096e-07 
    1 KSP Residual norm 2.163225005338e-12 
1.Gradient (dimensional) = -0.0000000006125339842794057678760379331406 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005527110651416590592156181009707 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015092034677706036682309082 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0462823 s
******************************************
Total solution time : 0.851533 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000000061253
2. Parameter value = 0.999999944729
mfit / mfit0 = 0.999999890137
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00000 
#    rho0[1] = 1.00000 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0162237 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0633469 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492586718738e+01 
    1 KSP Residual norm 1.087264196770e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.523831 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.372398004320e-06 
      |Div|_2   = 3.489134592486e-04 
   Momentum: 
      |mRes|_2  = 1.717514175838e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0647216 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019507845384
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.122198222084e-07 
    1 KSP Residual norm 2.163224485623e-12 
1.Gradient (dimensional) = -0.0000000006125338438085777652667803055118 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005527109445370455383649347672547 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015092042451232071386150665 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0497532 s
******************************************
Total solution time : 0.855175 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000000306267
2. Parameter value = 0.999999723644
mfit / mfit0 = 0.999999450677
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00000 
#    rho0[1] = 1.00000 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0176806 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0667837 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492586165750e+01 
    1 KSP Residual norm 1.087263967606e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.51966 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.372400312926e-06 
      |Div|_2   = 3.489134040006e-04 
   Momentum: 
      |mRes|_2  = 1.717514294158e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0629971 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019507811092
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.122190118027e-07 
    1 KSP Residual norm 2.163222598702e-12 
1.Gradient (dimensional) = -0.0000000006125332819217428959984630192580 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005527104621165919526265076262438 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015092073545440112345024895 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0452209 s
******************************************
Total solution time : 0.84935 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000001286321
2. Parameter value = 0.999998839307
mfit / mfit0 = 0.999997692831
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00001 
#    rho0[1] = 1.00000 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.016222 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0655425 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492583953804e+01 
    1 KSP Residual norm 1.087263051019e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.521062 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.372409547547e-06 
      |Div|_2   = 3.489131830093e-04 
   Momentum: 
      |mRes|_2  = 1.717514751951e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.06319 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019507673925
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.122157701879e-07 
    1 KSP Residual norm 2.163214819056e-12 
1.Gradient (dimensional) = -0.0000000006125310343843035300865347859696 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005527085324402433089678197616901 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015092197922070858521928320 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0456002 s
******************************************
Total solution time : 0.845521 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000005206539
2. Parameter value = 0.999995301956
mfit / mfit0 = 0.999990661473
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00002 
#    rho0[1] = 0.99998 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0164185 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0650475 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492575106094e+01 
    1 KSP Residual norm 1.087259384659e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.521515 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.372446485834e-06 
      |Div|_2   = 3.489122990512e-04 
   Momentum: 
      |mRes|_2  = 1.717516591312e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0635326 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019507125263
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.122028037235e-07 
    1 KSP Residual norm 2.163183977991e-12 
1.Gradient (dimensional) = -0.0000000006125220442347405572803483834478 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005527008137295422673059640618126 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015092695428616071068143867 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0455146 s
******************************************
Total solution time : 0.846487 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000020887410
2. Parameter value = 0.999981152552
mfit / mfit0 = 0.999962536290
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00008 
#    rho0[1] = 0.99992 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0161748 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0855541 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492539716443e+01 
    1 KSP Residual norm 1.087244719336e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.532698 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.372594238810e-06 
      |Div|_2   = 3.489087633375e-04 
   Momentum: 
      |mRes|_2  = 1.717523958532e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0628796 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019504930693
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.121509378745e-07 
    1 KSP Residual norm 2.163060560612e-12 
1.Gradient (dimensional) = -0.0000000006124860837210452396198812139837 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005526699388498122411262912612542 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015094685454423369558871540 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0457678 s
******************************************
Total solution time : 0.876667 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000083610894
2. Parameter value = 0.999924554935
mfit / mfit0 = 0.999850039537
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00033 
#    rho0[1] = 0.99970 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0165024 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0652456 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.492398176831e+01 
    1 KSP Residual norm 1.087186060234e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.520514 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.373185250877e-06 
      |Div|_2   = 3.488946223800e-04 
   Momentum: 
      |mRes|_2  = 1.717553423991e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0631111 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019496153651
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.119434745648e-07 
    1 KSP Residual norm 2.162567301175e-12 
1.Gradient (dimensional) = -0.0000000006123422428930825222228924232571 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005525464386352873181830494386379 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015102645553402006502793226 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0450032 s
******************************************
Total solution time : 0.845261 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.000334504828
2. Parameter value = 0.999698164471
mfit / mfit0 = 0.999400116087
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00134 
#    rho0[1] = 0.99879 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0162461 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0653419 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.491832322362e+01 
    1 KSP Residual norm 1.086951458113e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.521492 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.375549299321e-06 
      |Div|_2   = 3.488380889131e-04 
   Momentum: 
      |mRes|_2  = 1.717671737810e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0799079 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019461065325
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.111136227423e-07 
    1 KSP Residual norm 2.160593751443e-12 
1.Gradient (dimensional) = -0.0000000006117668992452415234621942317559 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005520524266758277189195297258301 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015134485879741949005501331 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.046499 s
******************************************
Total solution time : 0.863779 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.001338080565
2. Parameter value = 0.998792602612
mfit / mfit0 = 0.997601439418
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.00535 
#    rho0[1] = 0.99517 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0161827 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0646842 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.489573772302e+01 
    1 KSP Residual norm 1.086013600125e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.521246 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.385005496020e-06 
      |Div|_2   = 3.486124412669e-04 
   Momentum: 
      |mRes|_2  = 1.718151867583e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0834064 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000019321029490
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 9.077942380761e-07 
    1 KSP Residual norm 2.152699738658e-12 
1.Gradient (dimensional) = -0.0000000006094658393357665679546967613589 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005500762012759731979752185570371 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015261846070727761999312466 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0467854 s
******************************************
Total solution time : 0.86623 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.005352383515
2. Parameter value = 0.995170355178
mfit / mfit0 = 0.990423006545
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.02141 
#    rho0[1] = 0.98068 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0170438 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0651832 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.480617721584e+01 
    1 KSP Residual norm 1.082271015694e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.521719 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.422830325352e-06 
      |Div|_2   = 3.477176566462e-04 
   Momentum: 
      |mRes|_2  = 1.720182232412e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0631583 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000018765965249
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 8.945170618295e-07 
    1 KSP Residual norm 2.121124702607e-12 
1.Gradient (dimensional) = -0.0000000006002666343225703445272059731127 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005421684586857990851514999608776 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000015771269003903173010205929 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0456846 s
******************************************
Total solution time : 0.848526 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.021409595313
2. Parameter value = 0.980681365442
mfit / mfit0 = 0.961969636890
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.08564 
#    rho0[1] = 0.92273 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0166538 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0854611 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.446060749145e+01 
    1 KSP Residual norm 1.067444835196e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.525924 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 8.574130329977e-06 
      |Div|_2   = 3.442650955919e-04 
   Momentum: 
      |mRes|_2  = 1.730049326796e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0639048 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000016626950059
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 8.414141781335e-07 
    1 KSP Residual norm 1.994838928409e-12 
1.Gradient (dimensional) = -0.0000000005635503587227887082729622330419 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000005104920412443082026656092862191 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000017808675430443017160490188 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0462756 s
******************************************
Total solution time : 0.872337 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.085638442505
2. Parameter value = 0.922725406496
mfit / mfit0 = 0.852320725246
------------------------------------------

-------------------------------------------------------------------------- 
                   Lithosphere and Mantle Evolution Model                   
     Compiled: Date: Jan 11 2018 - Time: 09:52:00 	    
-------------------------------------------------------------------------- 
        STAGGERED-GRID FINITE DIFFERENCE CANONICAL IMPLEMENTATION           
-------------------------------------------------------------------------- 
Parsing input file : t7_AdjointGradientInversion.dat 
   Adding PETSc option: -snes_type ksponly
   Adding PETSc option: -js_ksp_type gmres
   Adding PETSc option: -js_ksp_max_it 25
   Adding PETSc option: -js_ksp_monitor
   Adding PETSc option: -js_ksp_rtol 1e-4
   Adding PETSc option: -js_ksp_atol 1e-10
   Adding PETSc option: -pcmat_type mono
   Adding PETSc option: -pcmat_pgamma 1e5
   Adding PETSc option: -jp_type user
   Adding PETSc option: -jp_pc_type lu
   Adding PETSc option: -objects_dump
   Adding PETSc option: -tao_fmin 1e-10
Finished parsing input file : t7_AdjointGradientInversion.dat 
--------------------------------------------------------------------------
Time stepping parameters:
   Simulation end time          : 1. [ ] 
   Maximum number of steps      : 1 
   Time step                    : 0.01 [ ] 
   Minimum time step            : 1e-05 [ ] 
   Maximum time step            : 0.1 [ ] 
   Time step increase factor    : 0.1 
   CFL criterion                : 0.5 
   CFLMAX (fixed time steps)    : 0.5 
   Output time step             : 0.2 [ ] 
   Output every [n] steps       : 1 
   Output [n] initial steps     : 1 
--------------------------------------------------------------------------
Material parameters: 
   Phase ID : 0
   (dens)   : rho = 2. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

   Phase ID : 1
   (dens)   : rho = 1. [ ]  
   (disl)   : eta0 = 1. [ ]  e0 = 1e-06 [ ]  Bn = 0.5 [ ]  n = 1. [ ]  

--------------------------------------------------------------------------
# ------------------------------------------------------------------------
# Material properties set from calling function: 
#    rho0[0] = 2.34255 
#    rho0[1] = 0.69090 
# ------------------------------------------------------------------------
Grid parameters:
   Total number of cpu                  : 2 
   Processor grid  [nx, ny, nz]         : [2, 1, 1]
   Fine grid cells [nx, ny, nz]         : [128, 2, 32]
   Number of cells                      :  8192
   Number of faces                      :  28992
   Maximum cell aspect ratio            :  2.50000
   Lower coordinate bounds [bx, by, bz] : [0., 0., 0.]
   Upper coordinate bounds [ex, ey, ez] : [10., 0.1, 1.]
--------------------------------------------------------------------------
Boundary condition parameters: 
   No-slip boundary mask [lt rt ft bk bm tp]  : 0 0 0 0 0 0 
--------------------------------------------------------------------------
Solution parameters & controls:
   Gravity [gx, gy, gz]                    : [0., 0., -1.] [ ] 
   Surface stabilization (FSSA)            :  1. 
   Use lithostatic pressure for creep      @ 
   Minimum viscosity                       : 0.001 [ ] 
   Maximum viscosity                       : 1e+12 [ ] 
   Background (reference) strain-rate      : 1e-06 [ ] 
   Ground water level type                 : none 
--------------------------------------------------------------------------
Advection parameters:
   Advection scheme              : Euler 1-st order (basic implementation)
   Marker setup scheme           : binary files (MATLAB)
   Velocity interpolation scheme : STAG (linear)
   Marker control type           : no marker control
   Markers per cell [nx, ny, nz] : [3, 3, 3] 
   Marker distribution type      : uniform
--------------------------------------------------------------------------
Loading markers in parallel from file(s) <./markers/mdb> ... done (0.0166512 sec)
--------------------------------------------------------------------------
Output parameters:
   Output file name                        : AdjointGradients_test 
   Write .pvd file                         : yes 
   Phase                                   @ 
   Density                                 @ 
   Total effective viscosity               @ 
   Creep effective viscosity               @ 
   Viscoplastic viscosity                  @ 
   Velocity                                @ 
   Pressure                                @ 
--------------------------------------------------------------------------
AVD output parameters:
   Write .pvd file       : yes 
   AVD refinement factor : 3 
--------------------------------------------------------------------------
Preconditioner parameters: 
   Matrix type                   : monolithic
   Penalty parameter (pgamma)    : 1.000000e+05
   Preconditioner type           : user-defined
--------------------------------------------------------------------------
Saving output ... done (0.0688384 sec)
--------------------------------------------------------------------------
================================= STEP 1 =================================
--------------------------------------------------------------------------
Current time        : 0.00000 [ ] 
Tentative time step : 0.01000 [ ] 
--------------------------------------------------------------------------
  0 PICARD ||F||/||F0||=1.000000e+00 
    Residual norms for js_ solve.
    0 KSP Residual norm 3.329152903650e+01 
    1 KSP Residual norm 1.010621848155e-04 
--------------------------------------------------------------------------
SNES Convergence Reason : maximum iterations reached
Number of iterations    : 1
SNES solution time      : 0.523613 (sec)
--------------------------------------------------------------------------
Residual summary: 
   Continuity: 
      |Div|_inf = 9.179341341549e-06 
      |Div|_2   = 3.325844164099e-04 
   Momentum: 
      |mRes|_2  = 1.796401098847e-03 
--------------------------------------------------------------------------
Actual time step : 0.01100 [ ] 
--------------------------------------------------------------------------
Saving output ... done (0.0628247 sec)
--------------------------------------------------------------------------
=========================== SOLUTION IS DONE! ============================
--------------------------------------------------------------------------
******************************************
      COMPUTATION OF THE COST FUNCTION
******************************************
Current Cost function = 0.00000000009369231663
******************************************
      COMPUTATION OF THE GRADIENTS
******************************************
    Residual norms for as_ solve.
    0 KSP Residual norm 6.290978697085e-07 
    1 KSP Residual norm 1.489923867578e-12 
1.Gradient (dimensional) = -0.0000000004179733427883372278053916635919 ; CurPar = 0 ; CurPhase = 0
2.Gradient (dimensional) = 0.0000000003830597656944803243118264552590 ; CurPar = 0 ; CurPhase = 1
Computation variable [Vz] (dimensional) = 0.000025953735358591798989451663 at Location x = 9.98 , y = 0.05 , z = 0.68
Computation was succesful & took 0.0461328 s
******************************************
Total solution time : 0.852022 (sec) 
--------------------------------------------------------------------------
1. Parameter value = 2.342553831275
2. Parameter value = 0.690901570713
mfit / mfit0 = 0.480279924908
------------------------------------------

------------------------------------------
Tao Object: 2 MPI processes
  type: lmvm
      BFGS steps: 1
      Scaled gradient steps: 1
      Gradient steps: 0
  TaoLineSearch Object:   2 MPI processes
    type: more-thuente
  convergence tolerances: gatol=1e-30,   steptol=0.,   gttol=1e-30
  Residual in Function/Gradient:=8.01794e-10
  convergence tolerances: function minimum=1e-10
  Objective value=9.36923e-11
  total number of iterations=1,                          (max: 2000)
  total number of function/gradient evaluations=13,      (max: 4000)
  Solution converged:    Minf --  f < fmin
------------------------------------------

------------------------------------------
*         INVERSION RESULT SUMMARY       *
------------------------------------------
Number of inversion iterations: 14
F/Fini:
0.000000000000000
1.000000000000000
0.999999890137059
0.999999450676753
0.999997692830713
0.999990661473401
0.999962536290256
0.999850039536632
0.999400116087328
0.997601439417588
0.990423006545050
0.961969636890174
0.852320725245631
0.480279924907868

Final cost function:
0.000000000093692

Final Parameters:
2.342553831275
0.690901570713
------------------------------------------

WARNING! There are options you set that were not used!
WARNING! could be spelling mistake, etc!
Option left: name:-tao_fmin value: 1e-10
